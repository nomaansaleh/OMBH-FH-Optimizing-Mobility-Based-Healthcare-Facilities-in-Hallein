<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/L.Control.Locate.min.css">
    <link rel="stylesheet" href="css/qgis2web.css">
    <link rel="stylesheet" href="css/fontawesome-all.min.css">
    <link rel="stylesheet" href="css/leaflet-measure.css">
    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css"
        integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
        crossorigin="" /> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/trafforddatalab/leaflet.reachability@v2.0.1/leaflet.reachability.css" />
    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <!--bootstrap cdn files-->
    <!-- CSS only -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="shortcut icon" href="images/favicon.ico">
    <!-- leaflet css -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" /> -->
    <!-- leaflet js -->
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>

    <link rel="stylesheet" href="css/TripgoRouting.css" />
    <!-- JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
    <script src="dist/TripgoRouting.js"></script>
    <script src="lib/Polyline.encoded.js"></script>
    <script src="lib/jquery-3.2.1.js"></script>

    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" /> -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" /> -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        html,
        body,
        #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }

        .reachability-control-settings-button {
            font-size: 22px;
        }

        #navstyle {
            background-color: #4B6151;
            color: #E3E0DB;
            padding: 10px 10px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            width: 100%;
            z-index: 1000;
        }
    </style>
    <title><X-TripGo-Key></title>
</head>

<body>
    <!-- Navigation Bar -->

    <div id="navstyle">
        <img src="icon/OMBH.png" alt="Logo"
            style="width: 35px; height: 35px; margin-right: 10px; vertical-align: middle;">
        OMBH-FH Optimizing Mobility Based Healthcare Facilities in Hallein
        <a href="https://arcg.is/0O45OP1" target="_blank"
            style="background-color: #E3E0DB; color: #4B6151; border: none; padding: 5px 15px; font-size: 16px; border-radius: 5px; cursor: pointer; text-decoration: none; margin-left: auto;">
            Suitability Analysis
        </a>
    </div>
    <div id="map">

    </div>
    <script src="js/leaflet.js"></script>
    <script src="js/L.Control.Locate.min.js"></script>
    <script src="js/leaflet.rotatedMarker.js"></script>
    <script src="js/leaflet.pattern.js"></script>
    <script src="js/leaflet-hash.js"></script>
    <script src="js/Autolinker.min.js"></script>
    <script src="js/rbush.min.js"></script>
    <script src="js/labelgun.min.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/leaflet-measure.js"></script>


    <!-- <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js" integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q==" crossorigin=""></script> -->
    <script
        src="https://cdn.jsdelivr.net/gh/trafforddatalab/leaflet.reachability@v2.0.0/leaflet.reachability.min.js"></script>
    <!-- <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script> -->
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <script>
        var map = L.map('map', {
            zoomControl: true, maxZoom: 28, minZoom: 3
        }).fitBounds([[13.0118829, 47.6823701], [13.1836118, 47.6545415]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({ truncate: { length: 30, location: 'smart' } });
        var bounds_group = new L.featureGroup([]);

        var infoBox = L.control({ position: 'bottomleft' });

        // Adding content to the box
        infoBox.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info-box'); // Create a div element for the box
            div.innerHTML = `
            <div style="background-color: white; padding: 10px; border: 2px solid #ccc; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); height:265px;width:270px">
                <p> This map highlights potential healthcare sites in the Hallein district, identified through a suitability analysis, along with existing healthcare facilities. Multimodal transport data (car, walking, cycling, etc.) is used to assess the accessibility and feasibility of these sites. The aim is to ensure equitable healthcare access for all communities by considering both site suitability and transportation infrastructure.


</p>
                <img src="icon/hallein.jpg" alt="img" style="width: 250px; height: 120px; border-radius: 5px;">
            </div>
        `;
            return div;
        };

        // Add the infoBox to the map
        infoBox.addTo(map);


        var layer_GoogleSatellite_1 = L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {

            attribution: '<a href="https://www.google.at/permissions/geoguidelines/attr-guide.html">Map data ©2015 Google</a>',
            minZoom: 1,
            maxZoom: 28,

        });

        var CartoDB_Positron = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 20
        });

        var OpenStreetMap_Mapnik = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Add the MapTiler raster tile layer above the CartoDB base map
        var mapTilerRasterLayer = L.tileLayer('https://api.maptiler.com/tiles/13f2f766-095c-4aac-8876-b7c88d3ff661/{z}/{x}/{y}.webp?key=Xwfs5KtFM8rerUjJCimF', {
            attribution: '&copy; <a href="https://www.maptiler.com/">MapTiler</a> contributors',
            tileSize: 512,
            zoomOffset: -1,
            crossOrigin: true,
            maxZoom: 20
        });


        var baseMaps = {};
        L.control.layers(baseMaps, { "Google Satellite": layer_GoogleSatellite_1, "Carto Map": CartoDB_Positron, "Open Street Map": OpenStreetMap_Mapnik, "Landuse <br><img src='icon/landuse.jpg' style='width: 150px; height: 140px; display: block; margin-top: 5px;'>": mapTilerRasterLayer }, { collapsed: false }).addTo(map);




        // // Add Routing Control
        // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        //     attribution: '© OpenStreetMap contributors'
        // }).addTo(map);
        // L.Routing.control({
        //     waypoints: [
        //         L.latLng(47.6823701, 13.0118829), // Start Point
        //         L.latLng(47.6545415, 13.1836118) // End Point
        //     ],
        //     routeWhileDragging: true,
        //     geocoder: L.Control.Geocoder.nominatim(), // Fixed the error by including the geocoder plugin
        //     createMarker: function (i, waypoint, n) {
        //         // Custom marker for start and end points
        //         var markerOptions = {
        //             draggable: true
        //         };
        //         return L.marker(waypoint.latLng, markerOptions).bindPopup(i === 0 ? 'Start' : i === n - 1 ? 'End' : 'Waypoint');
        //     }
        // }).addTo(map);




    </script>

    <script>
        // Example function to style the isoline polygons when they are returned from the API call
        function styleIsolines(feature) {
            // NOTE: You can do some conditional styling by reading the properties of the feature parameter passed to the function
            return {
                color: '#0073d4',
                opacity: 0.9,
                fillOpacity: 0.2
            };
        }

        // Example function to style the isoline polygons when the user hovers over them
        function highlightIsolines(e) {
            // NOTE: as shown in the examples on the Leaflet website, e.target = the layer the user is interacting with
            var layer = e.target;

            layer.setStyle({
                fillColor: '#ffea00',
                dashArray: '1,13',
                weight: 4,
                fillOpacity: '0.8',
                opacity: '1'
            });
        }

        // Example function to reset the style of the isoline polygons when the user stops hovering over them
        function resetIsolines(e) {
            // NOTE: as shown in the examples on the Leaflet website, e.target = the layer the user is interacting with
            var layer = e.target;

            reachabilityControl.isolinesGroup.resetStyle(layer);
        }

        // Example function to display information about an isoline in a popup when the user clicks on it
        function clickIsolines(e) {
            // NOTE: as shown in the examples on the Leaflet website, e.target = the layer the user is interacting with
            var layer = e.target;
            var props = layer.feature.properties;
            var popupContent = 'Mode of travel: ' + props['Travel mode'] + '<br />Range: 0 - ' + props['Range'] + ' ' + props['Range units'] + '<br />Area: ' + props['Area'] + ' ' + props['Area units'] + '<br />Population: ' + props['Population'];
            if (props.hasOwnProperty('Reach factor')) popupContent += '<br />Reach factor: ' + props['Reach factor'];
            layer.bindPopup(popupContent).openPopup();
        }

        // Example function to create a custom marker at the origin of the isoline groups
        function isolinesOrigin(latLng, travelMode, rangeType) {
            return L.circleMarker(latLng, { radius: 4, weight: 2, color: '#0073d4', fillColor: '#fff', fillOpacity: 1 });
        }

        // Add the reachability plugin
        var reachabilityControl = L.control.reachability({
            // add settings here
            apiKey: '5b3ce3597851110001cf6248b7afb0863361418daf0117c55e24904c', // PLEASE REGISTER WITH OPENROUTESERVICE FOR YOUR OWN KEY!
            styleFn: styleIsolines,
            mouseOverFn: highlightIsolines,
            mouseOutFn: resetIsolines,
            clickFn: clickIsolines,
            markerFn: isolinesOrigin,
            collapsed: false,
            expandButtonContent: '',
            expandButtonStyleClass: 'reachability-control-expand-button fa fa-bullseye',
            collapseButtonContent: '',
            collapseButtonStyleClass: 'reachability-control-collapse-button fa fa-caret-up',
            drawButtonContent: '',
            drawButtonStyleClass: 'fa fa-pencil',
            deleteButtonContent: '',
            deleteButtonStyleClass: 'fa fa-trash',
            distanceButtonContent: '',
            distanceButtonStyleClass: 'fa fa-road',
            timeButtonContent: '',
            timeButtonStyleClass: 'fa fa-clock-o',
            travelModeButton1Content: '',
            travelModeButton1StyleClass: 'fa fa-car',
            travelModeButton2Content: '',
            travelModeButton2StyleClass: 'fa fa-bicycle',
            travelModeButton3Content: '',
            travelModeButton3StyleClass: 'fa fa-male',
            travelModeButton4Content: '',
            travelModeButton4StyleClass: 'fa fa-wheelchair-alt'
        }).addTo(map);

        // Setup error handlers in case there is a problem when calling the API
        map.on('reachability:error', function () {
            alert('Unfortunately there has been an error calling the API.\nMore details are available in the console.');
        });

        map.on('reachability:no_data', function () {
            alert('Unfortunately no data was received from the API.\n');
        });

        // ALL Layer IN MAp VISUALIZATION
        var layerControl = L.control.layers(null, null, { collapsed: false }).addTo(map);

        // Road Layer Starts
        function style_Roads2_2_0() {
            return {
                opacity: 1,
                color: 'orange',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1,
                fillOpacity: 0,
                interactive: false,
            };
        }

        // Load and add the GeoJSON layer
        fetch('https://gist.githubusercontent.com/nomaansaleh/11bef64767d38219b6a8c62930f3f697/raw/a058f9e5cf94072025177cdc6be9caaaf1ebadcd/road.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                layer_Roads2_2 = L.geoJson(geojsonData, {
                    style: style_Roads2_2_0,
                    interactive: false
                });

                // Add the layer to the map
                layerControl.addOverlay(layer_Roads2_2, "<img src='icon/road.jpg' style='width: 15px; height: 15px;'> Roads");
                // Adjust the map view to the bounds of the GeoJSON
                map.fitBounds(layer_Roads2_2.getBounds());
            })
            .catch(error => console.error('Error loading GeoJSON:', error));


        // Bus Layer Start
        var busicon = L.icon({
            iconUrl: "icon/bus.svg", // Path to your bus icon
            iconSize: [16, 16], // Size of the icon
            iconAnchor: [7, 14] // Anchor point of the icon
        });

        // Function to style and use the bus icon for the GeoJSON bus stops layer
        function style_Bus(feature, latlng) {
            return L.marker(latlng, {
                icon: busicon // Assign the custom bus icon
            });
        }

        // Load and add the bus stops GeoJSON layer
        fetch('https://gist.githubusercontent.com/nomaansaleh/dd8f1c407d0bf9acbef46f94a12b5c5d/raw/2e3a910ca7454e994a365d1d643778c5e74e83db/busstop.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                var layer_Bus = L.geoJson(geojsonData, {
                    pointToLayer: style_Bus, // Use the style_Bus function to create markers with the bus icon
                    interactive: true
                }).addTo(map);

                // Add the layer to the layer control
                layerControl.addOverlay(layer_Bus, "<img src='icon/bus.svg' style='width: 15px; height: 15px;'> Bus Stops");
                // Adjust the map view to the bounds of the GeoJSON
                map.fitBounds(layer_Bus.getBounds());
            })
            .catch(error => console.error('Error loading GeoJSON:', error));

        //Hallein Boundary Layer Start
        function style_Area() {
            return {
                opacity: 1,
                color: 'black',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1,
                fillOpacity: 0,
                interactive: false,
            };
        }

        // Load and add the GeoJSON layer
        fetch('https://gist.githubusercontent.com/nomaansaleh/77e9b2e32fd13c2d3897bb340cb073e3/raw/c5bcc1fd83593bfca43eb9dcb286734477b8d320/hallein.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                layer_Area = L.geoJson(geojsonData, {
                    style: style_Area,
                    interactive: false
                }).addTo(map);

                // Add the layer to the map
                layerControl.addOverlay(layer_Area, "<img src='icon/Boundary.jpg' style='width: 15px; height: 15px;'> Hallein Boundary");
                // Adjust the map view to the bounds of the GeoJSON
                map.fitBounds(layer_Area.getBounds());
            })
            .catch(error => console.error('Error loading GeoJSON:', error));


        //hallein_health_cares Layer Start 

        var hospitalicon = L.icon({
            iconUrl: "icon/hospital-cross1.svg", // Ensure the file extension is included (e.g., .svg or .png)
            iconSize: [16, 16], // Size of the icon
            iconAnchor: [8, 16] // Anchor point of the icon (adjusted for centering)
        });

        // Function to style and use the hospital icon for the health care GeoJSON layer
        function style_Health_cares(feature, latlng) {
            return L.marker(latlng, {
                icon: hospitalicon // Assign the custom hospital icon
            });
        }

        // Load and add the health care GeoJSON layer
        fetch('https://gist.githubusercontent.com/nomaansaleh/e154e202524a38be40baf8b29582de22/raw/be704bc866be60190636b7ad61a96dd1eb14fb46/healthcare.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                var layer_Health_cares = L.geoJson(geojsonData, {
                    pointToLayer: style_Health_cares, // Use the style_Health_cares function to create markers with the hospital icon
                    interactive: true
                }).addTo(map);

                // Add the layer to the layer control
                layerControl.addOverlay(layer_Health_cares, "<img src='icon/hospital-cross1.svg' style='width: 15px; height: 15px;'> Health Care Facilities");

                // Adjust the map view to the bounds of the GeoJSON
                map.fitBounds(layer_Health_cares.getBounds());
            })
            .catch(error => console.error('Error loading GeoJSON:', error));

        //  Suitable Sites Data layer Start

        var suitablesitesicon = L.icon({
            iconUrl: "icon/hospital-build.svg", // Ensure the file extension is included (e.g., .svg or .png)
            iconSize: [20, 20], // Size of the icon
            iconAnchor: [8, 16] // Anchor point of the icon (adjusted for centering)
        });

        function style_suitable_sites(feature, latlng) {
            return L.marker(latlng, {
                icon: suitablesitesicon,
                // radius: 3, // Adjust the size of the points
                // fillColor: 'black',
                // color: 'black',
                // weight: 1,
                // opacity: 1,
                // fillOpacity: 1,
            });
        }
        // Load and add the GeoJSON layer
        fetch('https://gist.githubusercontent.com/nomaansaleh/e9ed1d4f6c72515e94d1f22b2adbc362/raw/0e6f4bfcd071c845975cb4df5fbd7256b3adc87f/suitable_sites.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                layer_suitbale_Health_cares = L.geoJson(geojsonData, {
                    pointToLayer: style_suitable_sites,
                    interactive: true
                }).addTo(map);

                // Add the layer to the map
                layerControl.addOverlay(layer_suitbale_Health_cares, "<img src='icon/hospital-build.svg' style='width: 15px; height: 15px;'> Suitable Sites");
                // Adjust the map view to the bounds of the GeoJSON
                map.fitBounds(layer_suitbale_Health_cares.getBounds());
            })
            .catch(error => console.error('Error loading GeoJSON:', error));




    </script>
    <!--firebase initiation-->

    <!-- auth js file -->
    <script src="js/auth.js"></script>
    <!-- map js file -->
    <script src="js/map.js"></script>
    <!-- App js file -->
    <script src="js/app.js"></script>
    <!-- Service worker js file-->
    <!-- <script src="sw.js"></script> -->
</body>

</html>
